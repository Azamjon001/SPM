# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –û—à–∏–±–∫–∞ "company_id cannot be null"

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–ü–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ PostgreSQL –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤:

```
‚ùå ERROR 23502: null value in column "company_id" of relation "products" 
   violates not-null constraint
```

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

| –î–æ | –ü–æ—Å–ª–µ |
|----|-------|
| ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ |
| ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Å–±–æ–µ–≤ |
| ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ |
| ‚ùå company_id –º–æ–≥ –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω | ‚úÖ company_id –∑–∞—â–∏—â–µ–Ω –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π |

## üìÇ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ö–æ–¥ (3 —Ñ–∞–π–ª–∞)
1. ‚úÖ `/supabase/functions/server/index.tsx` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. ‚úÖ `/utils/api.tsx` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
3. ‚úÖ `/components/DigitalWarehouse.tsx` - —É–±—Ä–∞–Ω spread –æ–ø–µ—Ä–∞—Ç–æ—Ä

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (4 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–∞)
1. üìÑ `/QUICK_FIX_GUIDE_RU.md` - –±—ã—Å—Ç—Ä–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
2. üìÑ `/COMPANY_ID_UPDATE_FIX.md` - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
3. üìÑ `/COMPANY_ID_FIX_VISUAL.md` - –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —Å—Ö–µ–º—ã
4. üìÑ `/FIX_SUMMARY_2026_01_10_COMPANY_ID.md` - –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞

### –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (1 —Ñ–∞–π–ª)
1. üìù `/COMPANY_ID_TYPE_FIX.md` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –Ω–æ–≤–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è spread –æ–ø–µ—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞–≤–∞–ª –≤–µ—Å—å –æ–±—ä–µ–∫—Ç:

```typescript
// ‚ùå –ë–´–õ–û:
await updateProduct(product.id, {
  ...product,  // –ü–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è –≤–µ—Å—å –æ–±—ä–µ–∫—Ç –≤–∫–ª—é—á–∞—è company_id
  category: newCategory
});
```

–ï—Å–ª–∏ `product.company_id` –±—ã–ª `null`, –æ–Ω –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –≤—ã–∑—ã–≤–∞–ª –æ—à–∏–±–∫—É.

### –†–µ—à–µ–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω–∞ **–¥–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞**:

**1. –ù–∞ –∫–ª–∏–µ–Ω—Ç–µ (`/utils/api.tsx`):**
```typescript
// ‚úÖ –°–¢–ê–õ–û:
export async function updateProduct(id: number, updates: any) {
  const cleanedUpdates = { ...updates };
  
  // –£–¥–∞–ª—è–µ–º company_id - –æ–Ω –Ω–µ –¥–æ–ª–∂–µ–Ω –º–µ–Ω—è—Ç—å—Å—è
  if (cleanedUpdates.company_id !== undefined) {
    delete cleanedUpdates.company_id;
  }
  
  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
}
```

**2. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (`/supabase/functions/server/index.tsx`):**
```typescript
// ‚úÖ –°–¢–ê–õ–û:
app.put("/make-server-6a74b22c/products/:id", async (c) => {
  const body = await c.req.json();
  
  // –£–¥–∞–ª—è–µ–º company_id - –æ–Ω –Ω–µ –¥–æ–ª–∂–µ–Ω –º–µ–Ω—è—Ç—å—Å—è
  if (body.company_id !== undefined) {
    console.log(`‚ö†Ô∏è –ü–æ–ø—ã—Ç–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—å company_id. –≠—Ç–æ –∑–∞–ø—Ä–µ—â–µ–Ω–æ!`);
    delete body.company_id;
  }
  
  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
});
```

**3. –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ (`/components/DigitalWarehouse.tsx`):**
```typescript
// ‚úÖ –°–¢–ê–õ–û:
await updateProduct(product.id, {
  category: newCategory  // –¢–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ–µ –ø–æ–ª–µ
});
```

## üõ°Ô∏è –ó–∞—â–∏—Ç–∞

–¢–µ–ø–µ—Ä—å `company_id`:
- ‚úÖ –ù–ï –ú–û–ñ–ï–¢ –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞
- ‚úÖ –£–¥–∞–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- ‚úÖ –£–¥–∞–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–¥–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞)
- ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –¢–û–õ–¨–ö–û –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
üëâ **[QUICK_FIX_GUIDE_RU.md](QUICK_FIX_GUIDE_RU.md)** - –Ω–∞—á–Ω–∏—Ç–µ –∑–¥–µ—Å—å

### –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏
- üîß **[COMPANY_ID_UPDATE_FIX.md](COMPANY_ID_UPDATE_FIX.md)** - –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
- üé® **[COMPANY_ID_FIX_VISUAL.md](COMPANY_ID_FIX_VISUAL.md)** - –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —Å—Ö–µ–º—ã
- üìã **[FIX_SUMMARY_2026_01_10_COMPANY_ID.md](FIX_SUMMARY_2026_01_10_COMPANY_ID.md)** - —Å–≤–æ–¥–∫–∞

### –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã
- **[COMPANY_ID_TYPE_FIX.md](COMPANY_ID_TYPE_FIX.md)** - —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö company_id
- **[BARCODE_BARID_FIX.md](BARCODE_BARID_FIX.md)** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 22P02
- **[DOCUMENTATION_INDEX.md](DOCUMENTATION_INDEX.md)** - –ø–æ–ª–Ω—ã–π –∏–Ω–¥–µ–∫—Å

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
```
1. –ü–∞–Ω–µ–ª—å "–¶–∏—Ñ—Ä–æ–≤–æ–π —Å–∫–ª–∞–¥"
2. –ù–∞–∂–∞—Ç—å "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" –Ω–∞ —Ç–æ–≤–∞—Ä–µ
3. –ò–∑–º–µ–Ω–∏—Ç—å —Ü–µ–Ω—É/–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
4. –ù–∞–∂–∞—Ç—å "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
‚úÖ –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫
```

### 2. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```
1. –ü–∞–Ω–µ–ª—å "–¶–∏—Ñ—Ä–æ–≤–æ–π —Å–∫–ª–∞–¥"
2. –ù–∞–π—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é
3. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å"
4. –í–≤–µ—Å—Ç–∏ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
5. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
‚úÖ –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫
```

### 3. –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
```
1. –û—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω—Å–æ–ª—å (F12)
2. –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
‚ùå –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ PostgreSQL 23502
‚úÖ –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:
   ‚ö†Ô∏è [Update Product] –ü–æ–ø—ã—Ç–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—å company_id. –≠—Ç–æ –∑–∞–ø—Ä–µ—â–µ–Ω–æ!
   (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - –∑–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç)
```

## üéì –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –ü—Ä–∏–Ω—Ü–∏–ø –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç–∏ company_id
```
–°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ ‚Üí company_id —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
       ‚Üì
   –ù–ò–ö–û–ì–î–ê –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
       ‚Üì
–¢–æ–≤–∞—Ä –Ω–∞–≤—Å–µ–≥–¥–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∫–æ–º–ø–∞–Ω–∏–∏
```

### –ö–∞–∫ –ù–ï –Ω–∞–¥–æ –¥–µ–ª–∞—Ç—å
```typescript
‚ùå await updateProduct(product.id, {
     ...product,  // –ù–ï –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –≤–µ—Å—å –æ–±—ä–µ–∫—Ç!
     price: newPrice
   });
```

### –ö–∞–∫ –Ω–∞–¥–æ –¥–µ–ª–∞—Ç—å
```typescript
‚úÖ await updateProduct(product.id, {
     price: newPrice  // –¢–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—è–µ–º—ã–µ –ø–æ–ª—è
   });
```

## üÜò –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–ª–∞—Å—å

1. **–û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞**
   - F12 ‚Üí –ü—Ä–∞–≤–∞—è –∫–Ω–æ–ø–∫–∞ –Ω–∞ "–û–±–Ω–æ–≤–∏—Ç—å" ‚Üí "–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à"

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö**
   ```sql
   -- –ù–∞–π—Ç–∏ —Ç–æ–≤–∞—Ä—ã —Å NULL company_id
   SELECT id, name, company_id FROM products WHERE company_id IS NULL;
   
   -- –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å
   UPDATE products SET company_id = 1 WHERE company_id IS NULL;
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é —Ñ–∞–π–ª–æ–≤**
   - –í `/supabase/functions/server/index.tsx` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
     ```typescript
     if (body.company_id !== undefined) {
       delete body.company_id;
     }
     ```

4. **–°–≤—è–∂–∏—Ç–µ—Å—å —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º**
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ü–û–õ–ù–´–ô —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏
   - –û–ø–∏—à–∏—Ç–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- üîß **–§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ:** 3
- üìÑ **–§–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–æ:** 4
- ‚è±Ô∏è **–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** ~10 –º–∏–Ω—É—Ç
- üéØ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô
- ‚úÖ **–°—Ç–∞—Ç—É—Å:** –ò–°–ü–†–ê–í–õ–ï–ù–û –ò –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–û

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- üìö **[DOCUMENTATION_INDEX.md](DOCUMENTATION_INDEX.md)** - –∏–Ω–¥–µ–∫—Å –≤—Å–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- üîí **[SECURITY_QUICK_START.md](SECURITY_QUICK_START.md)** - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- üè¢ **[CUSTOMER_REGISTRATION_MODES.md](CUSTOMER_REGISTRATION_MODES.md)** - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

---

**–î–∞—Ç–∞:** 10 —è–Ω–≤–∞—Ä—è 2026  
**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ï–ù–£
