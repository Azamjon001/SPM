# üìã –°–í–û–î–ö–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô: company_id - 10 —è–Ω–≤–∞—Ä—è 2026

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ PostgreSQL:

```
‚ùå Error: null value in column "company_id" of relation "products" violates not-null constraint
```

## üîç –ü—Ä–∏—á–∏–Ω–∞

1. –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `DigitalWarehouse.tsx` –ø—Ä–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è spread –æ–ø–µ—Ä–∞—Ç–æ—Ä:
   ```typescript
   await updateProduct(product.id, {
     ...product,  // ‚ùå –ü–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è –≤–µ—Å—å –æ–±—ä–µ–∫—Ç –≤–∫–ª—é—á–∞—è company_id
     category: newCategory
   });
   ```

2. –ï—Å–ª–∏ `product.company_id` –±—ã–ª `null` –∏–ª–∏ `undefined`, —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–æ—Å—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä

3. –°–µ—Ä–≤–µ—Ä –ø—ã—Ç–∞–ª—Å—è –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–≤–∞—Ä —Å `company_id = null`, —á—Ç–æ –Ω–∞—Ä—É—à–∞–ª–æ NOT NULL constraint

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –ò–∑–º–µ–Ω–µ–Ω–æ 3 —Ñ–∞–π–ª–∞:

#### 1. `/supabase/functions/server/index.tsx`
```typescript
// ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ company_id –∏–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
if (body.company_id !== undefined) {
  console.log(`‚ö†Ô∏è [Update Product] –ü–æ–ø—ã—Ç–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—å company_id –¥–ª—è —Ç–æ–≤–∞—Ä–∞ ${id}. –≠—Ç–æ –∑–∞–ø—Ä–µ—â–µ–Ω–æ!`);
  delete body.company_id;
}

// ‚úÖ –£–±—Ä–∞–Ω company_id –∏–∑ —Å–ø–∏—Å–∫–∞ numericFields
const numericFields = ['price', 'markup_percent', 'markup_amount', 'selling_price', 'quantity', 'barcode', 'barid'];
```

#### 2. `/utils/api.tsx`
```typescript
export async function updateProduct(id: number, updates: any) {
  const cleanedUpdates = { ...updates };
  
  // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ company_id
  if (cleanedUpdates.company_id !== undefined) {
    console.log(`‚ö†Ô∏è [updateProduct] –ü–æ–ø—ã—Ç–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—å company_id –¥–ª—è —Ç–æ–≤–∞—Ä–∞ ${id}. –≠—Ç–æ –∑–∞–ø—Ä–µ—â–µ–Ω–æ!`);
    delete cleanedUpdates.company_id;
  }
  
  // ‚úÖ –£–±—Ä–∞–Ω company_id –∏–∑ numericFields
  const numericFields = ['price', 'markup_percent', 'markup_amount', 'selling_price', 'quantity', 'barcode', 'barid'];
  
  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
}
```

#### 3. `/components/DigitalWarehouse.tsx`

**–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 987):**
```typescript
// ‚ùå –ë—ã–ª–æ:
await updateProduct(product.id, {
  ...product,
  category: editCategoryName.trim()
});

// ‚úÖ –°—Ç–∞–ª–æ:
await updateProduct(product.id, {
  category: editCategoryName.trim()
});
```

**–£–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 1047):**
```typescript
// ‚ùå –ë—ã–ª–æ:
await updateProduct(product.id, {
  ...product,
  category: ''
});

// ‚úÖ –°—Ç–∞–ª–æ:
await updateProduct(product.id, {
  category: ''
});
```

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

| –î–æ | –ü–æ—Å–ª–µ |
|----|-------|
| ‚ùå –û—à–∏–±–∫–∞ PostgreSQL 23502 | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| ‚ùå company_id –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ | ‚úÖ company_id –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è |
| ‚ùå Spread –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–µ—Ä–µ–¥–∞–≤–∞–ª –≤–µ—Å—å –æ–±—ä–µ–∫—Ç | ‚úÖ –ü–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è |
| ‚ùå –¢–æ–≤–∞—Ä –º–æ–≥ —Å–º–µ–Ω–∏—Ç—å –∫–æ–º–ø–∞–Ω–∏—é | ‚úÖ company_id –Ω–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è |

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–¢–µ–ø–µ—Ä—å —Ç–æ–≤–∞—Ä **–ù–ï –ú–û–ñ–ï–¢** —Å–º–µ–Ω–∏—Ç—å –∫–æ–º–ø–∞–Ω–∏—é –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏:
- ‚úÖ `company_id` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞
- ‚úÖ `company_id` –ù–ï –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
- ‚úÖ –î–∞–∂–µ –µ—Å–ª–∏ `company_id` —Å–ª—É—á–∞–π–Ω–æ –ø–µ—Ä–µ–¥–∞–Ω, –æ–Ω —É–¥–∞–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –±–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ: —Ç–æ–≤–∞—Ä –Ω–µ –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –º–µ–∂–¥—É –∫–æ–º–ø–∞–Ω–∏—è–º–∏

## üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–æ–∑–¥–∞–Ω–æ 2 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–∞:
1. `/COMPANY_ID_UPDATE_FIX.md` - –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2. `/FIX_SUMMARY_2026_01_10_COMPANY_ID.md` - —ç—Ç–∞ —Å–≤–æ–¥–∫–∞

–û–±–Ω–æ–≤–ª–µ–Ω 1 —Ñ–∞–π–ª:
1. `/COMPANY_ID_TYPE_FIX.md` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –Ω–æ–≤–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ - –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å
2. ‚úÖ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ - –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å
3. ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ - –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å
4. ‚úÖ –í –∫–æ–Ω—Å–æ–ª–∏ –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ PostgreSQL 23502
5. ‚úÖ –í –∫–æ–Ω—Å–æ–ª–∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –∏–∑–º–µ–Ω–∏—Ç—å company_id

---

**–î–∞—Ç–∞:** 10 —è–Ω–≤–∞—Ä—è 2026  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û  
**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:** 3  
**–°–æ–∑–¥–∞–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** 2 —Ñ–∞–π–ª–∞  
**–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** ~10 –º–∏–Ω—É—Ç

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

- `/BARCODE_BARID_FIX.md` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ PostgreSQL 22P02
- `/COMPANY_ID_TYPE_FIX.md` - –†–∞–∑–ª–∏—á–∏–µ —Ç–∏–ø–æ–≤ company_id –≤ users –∏ products
- `/PRODUCTS_COMPANY_ID_FIX.md` - –û–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
