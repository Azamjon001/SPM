# üöÄ –ë–´–°–¢–†–û–ï –†–£–ö–û–í–û–î–°–¢–í–û: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ "company_id cannot be null"

## ‚úÖ –ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û

–ü–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –æ—à–∏–±–∫–∞ PostgreSQL –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤:
```
‚ùå null value in column "company_id" of relation "products" violates not-null constraint
```

## üîß –ö–ê–ö –≠–¢–û –†–ê–ë–û–¢–ê–õ–û –†–ê–ù–¨–®–ï (‚ùå –ü–†–û–ë–õ–ï–ú–ê)

1. –ü—Ä–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–æ–¥ –ø–µ—Ä–µ–¥–∞–≤–∞–ª **–≤–µ—Å—å –æ–±—ä–µ–∫—Ç —Ç–æ–≤–∞—Ä–∞**
2. –ï—Å–ª–∏ –≤ –æ–±—ä–µ–∫—Ç–µ `product.company_id` –±—ã–ª `null`, –æ–Ω –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä
3. –°–µ—Ä–≤–µ—Ä –ø—ã—Ç–∞–ª—Å—è –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–≤–∞—Ä —Å `company_id = null`
4. PostgreSQL –≤—ã–¥–∞–≤–∞–ª –æ—à–∏–±–∫—É, –ø–æ—Ç–æ–º—É —á—Ç–æ `company_id` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ

## üéâ –ö–ê–ö –≠–¢–û –†–ê–ë–û–¢–ê–ï–¢ –°–ï–ô–ß–ê–° (‚úÖ –†–ï–®–ï–ù–ò–ï)

1. –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞ `company_id` **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è** –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
2. –î–∞–∂–µ –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥–∞—Ç—å `company_id`, –æ–Ω –±—É–¥–µ—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω
3. –í –∫–æ–Ω—Å–æ–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:
   ```
   ‚ö†Ô∏è [Update Product] –ü–æ–ø—ã—Ç–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—å company_id –¥–ª—è —Ç–æ–≤–∞—Ä–∞ 3391. –≠—Ç–æ –∑–∞–ø—Ä–µ—â–µ–Ω–æ!
   ```
4. **–¢–æ–≤–∞—Ä –ù–ï –ú–û–ñ–ï–¢ —Å–º–µ–Ω–∏—Ç—å –∫–æ–º–ø–∞–Ω–∏—é** - —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –±–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ

## üìÇ –ß–¢–û –ò–ó–ú–ï–ù–ò–õ–û–°–¨

### 3 —Ñ–∞–π–ª–∞ —Å –∫–æ–¥–æ–º:
1. ‚úÖ `/supabase/functions/server/index.tsx` - —Å–µ—Ä–≤–µ—Ä —É–¥–∞–ª—è–µ—Ç company_id
2. ‚úÖ `/utils/api.tsx` - –∫–ª–∏–µ–Ω—Ç —É–¥–∞–ª—è–µ—Ç company_id
3. ‚úÖ `/components/DigitalWarehouse.tsx` - –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è

### 3 —Ñ–∞–π–ª–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
1. üìÑ `/COMPANY_ID_UPDATE_FIX.md` - –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
2. üìÑ `/FIX_SUMMARY_2026_01_10_COMPANY_ID.md` - –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞
3. üìÑ `/QUICK_FIX_GUIDE_RU.md` - —ç—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## üß™ –ö–ê–ö –ü–†–û–í–ï–†–ò–¢–¨

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å "–¶–∏—Ñ—Ä–æ–≤–æ–π —Å–∫–ª–∞–¥"
2. –ù–∞–∂–º–∏—Ç–µ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" –Ω–∞ –ª—é–±–æ–º —Ç–æ–≤–∞—Ä–µ
3. –ò–∑–º–µ–Ω–∏—Ç–µ —Ü–µ–Ω—É –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
4. –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
5. ‚úÖ –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –ë–ï–ó –æ—à–∏–±–æ–∫

### 2. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å "–¶–∏—Ñ—Ä–æ–≤–æ–π —Å–∫–ª–∞–¥"
2. –ù–∞–π–¥–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Å —Ç–æ–≤–∞—Ä–∞–º–∏
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å" (–∏–∫–æ–Ω–∫–∞ –∫–∞—Ä–∞–Ω–¥–∞—à–∞)
4. –í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
5. –ù–∞–∂–º–∏—Ç–µ –≥–∞–ª–æ—á–∫—É (‚úì)
6. ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–ª–∂–Ω–∞ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å—Å—è –ë–ï–ó –æ—à–∏–±–æ–∫

### 3. –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å "–¶–∏—Ñ—Ä–æ–≤–æ–π —Å–∫–ª–∞–¥"
2. –ù–∞–π–¥–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Å —Ç–æ–≤–∞—Ä–∞–º–∏
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–£–¥–∞–ª–∏—Ç—å" (–∏–∫–æ–Ω–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã)
4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ
5. ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–ª–∂–Ω–∞ —É–¥–∞–ª–∏—Ç—å—Å—è –ë–ï–ó –æ—à–∏–±–æ–∫

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å–æ–ª–∏
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –ª—é–±—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
3. ‚ùå –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ PostgreSQL 23502
4. ‚úÖ –ú–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤–∏–¥–∞:
   ```
   ‚ö†Ô∏è [Update Product] –ü–æ–ø—ã—Ç–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—å company_id –¥–ª—è —Ç–æ–≤–∞—Ä–∞ X. –≠—Ç–æ –∑–∞–ø—Ä–µ—â–µ–Ω–æ!
   ```
   –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∑–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç.

## üí° –ü–û–ß–ï–ú–£ –≠–¢–û –í–ê–ñ–ù–û

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –¢–æ–≤–∞—Ä —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å `company_id` –∏ **–ù–ò–ö–û–ì–î–ê** –Ω–µ –º–µ–Ω—è–µ—Ç –∫–æ–º–ø–∞–Ω–∏—é
- ‚úÖ –≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ —Ç–æ–≤–∞—Ä–æ–≤ –¥—Ä—É–≥–æ–π –∫–æ–º–ø–∞–Ω–∏–∏
- ‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è —Ü–µ–ª–æ—Å—Ç–Ω—ã–º–∏

### –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ø—Ä–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

## üîç –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
| –¢–∞–±–ª–∏—Ü–∞ | –ü–æ–ª–µ | –¢–∏–ø | Constraint |
|---------|------|-----|------------|
| `products` | `company_id` | INTEGER | NOT NULL |
| `products` | `price` | NUMERIC(10,2) | |
| `products` | `quantity` | INTEGER | |
| `products` | `barcode` | TEXT/NUMERIC | |
| `products` | `barid` | INTEGER/NUMERIC | |

### –ì–¥–µ –ù–ï –Ω—É–∂–µ–Ω company_id
–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞ (`updateProduct`) –ù–ï –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è:
- ‚ùå `company_id` - —É–¥–∞–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚ùå `id` - –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º
- ‚ùå `created_at` - –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è

–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –¢–û–õ–¨–ö–û:
- ‚úÖ `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ
- ‚úÖ `price` - —Ü–µ–Ω–∞
- ‚úÖ `quantity` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- ‚úÖ `markup_percent` - –ø—Ä–æ—Ü–µ–Ω—Ç –Ω–∞—Ü–µ–Ω–∫–∏
- ‚úÖ `category` - –∫–∞—Ç–µ–≥–æ—Ä–∏—è
- ‚úÖ `barcode` - —à—Ç—Ä–∏—Ö–∫–æ–¥
- ‚úÖ `barid` - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–¥

## üÜò –ß–¢–û –î–ï–õ–ê–¢–¨ –ï–°–õ–ò –ü–†–û–ë–õ–ï–ú–ê –û–°–¢–ê–õ–ê–°–¨

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é —Ñ–∞–π–ª–æ–≤
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª—ã –±—ã–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã:
```bash
# –í /supabase/functions/server/index.tsx –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
if (body.company_id !== undefined) {
  delete body.company_id;
}
```

### 2. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –ù–∞–∂–º–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –Ω–∞ –∫–Ω–æ–ø–∫—É "–û–±–Ω–æ–≤–∏—Ç—å"
3. –í—ã–±–µ—Ä–∏—Ç–µ "–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∂—ë—Å—Ç–∫—É—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É"

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ
–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è, –≤–æ–∑–º–æ–∂–Ω–æ –µ—Å—Ç—å —Ç–æ–≤–∞—Ä—ã —Å `company_id = null` –≤ –±–∞–∑–µ:
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ —Å NULL company_id
SELECT id, name, company_id FROM products WHERE company_id IS NULL;

-- –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã - —É–¥–∞–ª–∏—Ç–µ –∏–ª–∏ –∏—Å–ø—Ä–∞–≤—å—Ç–µ –∏—Ö
DELETE FROM products WHERE company_id IS NULL;
-- –∏–ª–∏
UPDATE products SET company_id = 1 WHERE company_id IS NULL;
```

### 4. –°–≤—è–∂–∏—Ç–µ—Å—å —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º
–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–ª–æ:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ü–û–õ–ù–´–ô —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –¥–µ–π—Å—Ç–≤–∏–π

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–∞—Ö:
- `/COMPANY_ID_UPDATE_FIX.md` - –ø–æ–ª–Ω–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
- `/FIX_SUMMARY_2026_01_10_COMPANY_ID.md` - –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `/COMPANY_ID_TYPE_FIX.md` - —Ä–∞–∑–ª–∏—á–∏—è —Ç–∏–ø–æ–≤ –≤ users –∏ products
- `/BARCODE_BARID_FIX.md` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 22P02

---

**–î–∞—Ç–∞:** 10 —è–Ω–≤–∞—Ä—è 2026  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û –ò –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–û  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô  
**–í—Ä–µ–º—è –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** ~10 –º–∏–Ω—É—Ç
